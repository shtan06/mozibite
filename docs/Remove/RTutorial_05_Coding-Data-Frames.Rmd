---
title: "Session Three (Part 3): Coding - Data Frames"
author: "Estimated Duration: 30 minutes"
output:
  html_document: 
    code_folding: show
    highlight: tango
    number_sections: no
    theme: sandstone
    toc: yes
    toc_depth: 5
    toc_float:
      collapsed: no
      smooth_scroll: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
<br>

### __Data Frames__

<br>

Data frames tabulate data in spreadsheet-like format. Each column can have different data types.  

<br>

#### Create a Data Frame
```{r}
df1 <- data.frame(x=letters[1:5], y=rnorm(5), z=runif(5)>0.5,
                  status=factor(c("Open","Closed","Closed","Open","Pending")))
df1
```

  * `View(df1)` displays all data in a separate data file  
  * `edit(df1)` requires XQuartz if using MacOS  

<br>

#### Examine the Data Frame

```{r}
class(df1)
summary(df1)
str(df1)
head(df1,3) # displays first 3 rows of data. Default is 6.
tail(df1) # displays last 6 rows of data by default. Use tail(df1,n) for n number of rows.
rownames(df1)
colnames(df1) # displays all column names. Alternatively, names(df1) or ls(df1)
nrow(df1)
ncol(df1) # or length(df1)
dim(df1)
dimnames(df1)
```
<br>

#### Access and Manipulate Data Frames  

<br>

**Using indexing to extract values**  

```{r echo=FALSE}
df1
```

```{r}
df1[3,2] # dataframe[row,col]
df1[3:5,]
df1[,2] # results displayed as vector
df1[,2, drop=FALSE] # results displayed as data frame
df1[c(1,4),"z"]
df1[4] # if comma is left out, default refers to column number
df1[c(-1,-3),] # all except rows 1 and 3
```
<br>

**Select/filter data frame by component values**  

```{r}
df1$y
mean(df1$y)
with(df1,mean("y")) # with eliminates the use of $
with(df1,mean(y[z=="TRUE"]))
df1[["y"]]
df1["y"]
sum(df1["y"])
df1$x[df1$z=="FALSE" & df1$status=="Closed"]  
df1[df1$z=="FALSE"|df1$status=="Closed",]  
aggregate(df1$y,by=list(df1$z), FUN=sum) # group the data by TRUE/FALSE and sum(y)
```
<br>

**Look-up row numbers**  

```{r}
which(df1$z=="TRUE")
```
<br>

**Replacing Values**  
This method is similar to re-assigning the data frame  

```{r eval=FALSE}
df1[3,"x"] <- "k" # or use = sign. This example replaces the value x with k. 
df1$x[df1$status=="Pending"]="-" # replaces values in column x to "-" where status is "Pending"
```
<br>

**Add a row**   

```{r eval=FALSE}
df1 <- rbind(df1,list("g",0.21, "FALSE","Closed"))  
# this reassigns df1 by combining existing data with the new row of values. If you assign a different variable name, eg. df2, it will combine existing values in df1 with the new value, but does not affect df1.
```
<br>

**Add a column**  

```{r eval=FALSE} 
df1 <- cbind(df1,status2=c(1,3,2,3,2,1))
```
<br>

**Delete Row**  

```{r eval=FALSE}
df1 <- df1[-4,] # remove row 4. This method reassigns the data frame by excluding one or more rows using indexing  
```
<br>

**Delete Column**  

```{r eval=FALSE}
df1$status2 <- NULL
```
<br>

**Change row names**  
Default row names are incremental integers. Row names can be changed during or after constructing the data frame.  

```{r eval=FALSE}
row.names(df1) <- c("1st","2nd","3rd","4th","5th","6th") # or
rownames(df1) <- c("1st","2nd","3rd","4th","5th","6th")
```
<br>

**Change column names**

```{r eval=FALSE}
names(df1) <- c(1,2,3,4,5) #or
colnames(df1) <- c(1,2,3,4,5)
```

**Calculate column and row sums and mean**  

If data frame contains only numbers, use:

  * `colSums()`
  * `colMeans()`
  * `rowSums()`
  * `rowMeans()`  

<br><br>

#### Datasets Stored in Packages

<br>

Code | Description
---- | -----------
`data(package=.packages(TRUE))` | Displays list of all datasets found in base packages  
`data(package="MASS")` | Displays list of datasets in a package (make sure the package is loaded)  
`data(iris)` | Or just type iris to display on console (does not work if dataframe is not in packages)  

<br>

**Examine the iris Dataset**

<br>

Code | Code | Code | Code
---- | ---- | ---- | ----
`View(iris)` | `str(iris)` | `colnames(iris)` | `dim(iris)`
`class(iris)` | `head(iris)`  | `nrow(iris)` | `dimnames(iris)`
`summary(iris)` | `rownames(iris)` | `ncol(iris)` or `length(iris)`

<br>

#### Factors and Levels

A factor is a class type that contains pre-defined, finite number of values (categorical data). The categorical values are called levels.  

<br>

__To create a factor:__  
`status <- factor(c("Open","Closed","Closed","Open","Unknown"))`  

Examples:  

`df1 <- data.frame(x=letters[1:5],y=rnorm(5),z=runif(5)>0.5,status=factor(c("Open","Closed","Closed","Open","Unknown")))`

In the iris dataset, "Species" is a factor with 3 levels. Run str(iris) to check.

Level information:  
`levels(iris$_columnname_)`  
`nlevels(iris$_columnname_)`

<br>
<br>
