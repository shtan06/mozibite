<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Sum of Geometric Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="GeometricSum.html">Posts</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Sum of Geometric Series</h1>

</div>


<div id="sum-of-a-geometric-series" class="section level3">
<h3>Sum of a Geometric Series</h3>
<p>Excel’s built-in functions are useful only if you depend entirely on spreadsheets to generate financial numbers. If you already understand the common finance terms and their meanings, but want to know more about the mathematics behind it (perhaps you want write a simple financial program), it is important to realise that most calculations involving loans and bonds comes from the time value of moeny formula. Take a look at some of the financial functions available in Excel - IRR, FV, NPV, PMT, PRICE and YIELD. They are all derived from the same formula; the only difference is the input you provide as function variables required under different objectives and assumptions. It is also worth noting that where lengthy time series make computation more tedious, one of the most useful formula to apply is the geometric series formula. Most of you will recall learning it in algebra class but never had the chance to use it in real life. Blame it on computers, maybe, but We have come to be more familiar with the name of mathematical functions than the actual formula itself.</p>
<p>A geometric progression is a sequence obtained by multiplying the preceding term by a constant, called a common ratio. The sequence [3, 6, 12, 24, 48, 96] follows a geometric progression <span class="math inline">\(a, ar, ar^2, ar^3, ar^4\)</span>. The first term , <em>a</em>, is 3 and the common ratio, <em>r</em> is 2. The number of terms, <em>n</em>, in the series is 5.</p>
<p>The sum of the first <em>n</em> terms of a geometric progression is given by:</p>
<p><span class="math display">\[S_n=a~+~ar~+~ar^2~+~...~+ ar^{n-1}\]</span> Notice the similarity with formulas such as the time value of multiple cash flows.</p>
<p><span class="math inline">\(Present Value=\frac{C_1}{(1+r)^1}+\frac{C_2}{(1+r)^2}+\frac{C_3}{(1+r)^3}+...\frac{C_n}{(1+r)^n}\)</span></p>
<p>Calculation using the expanded form can be tedious When <em>n</em> is large. Fortunately, we can use a simple formula.</p>
<p><span class="math inline">\(S_n=a+ar+ar^2+ar^3+...+ar^{n-3}+ar^{n-2}+ar^{n-1}\)</span></p>
<p><span class="math inline">\(S_n=a+r(a+ar+ar^2+...+ar^{n-3}+ar^{n-2})\)</span></p>
<p><span class="math inline">\(S_n=a+r(S_n-ar^{n-1})\)</span></p>
<p><span class="math inline">\(S_n=a+rS_n-ar^n\)</span></p>
<p><span class="math inline">\(S_n-rS_n=a-ar^n\)</span></p>
<p><span class="math inline">\(S_n(1-r)=a(1-r^n)\)</span></p>
<p><span class="math display">\[S_n=\frac{a(1-r^n)}{1-r}\]</span></p>
<p>Using this formula, we can find the present value by substituting:</p>
<p><span class="math inline">\(S_n = PV\)</span>, <span class="math inline">\(a=\frac{C}{1+r}\)</span>, <span class="math inline">\(r=\frac{1}{1+r}\)</span>, <span class="math inline">\(n=n\)</span></p>
<p>and we get:</p>
<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><span class="math display">\[PV=C~\frac{1-(1+r)^{-n}}{r}\]</span></p>
</div>
</div>
<div id="periodic-payment-formula" class="section level3">
<h3>Periodic Payment Formula</h3>
<p>Back to the loan example shown in Section 1.1. How do you manually calculate the monthly payment? <br><br> <strong>Monthly Payment Amount</strong> <span class="math display">\[A = \frac{Pr(1+r)^n}{(1+r)^n-1}\]</span></p>
<pre><code>      where
             A = Periodic Payment Amount
             P = Present Value of Loan (Initial Loan Amount)
             r = Interest rate for each period
             n = Number of periods</code></pre>
<p>From the loan example:</p>
<p>P = $200,000<br />
r = 0.005 (6.0% p.a. divided by 12)<br />
n = 24 (number of periods or months up to maturity)</p>
<p><span class="math inline">\(A = \frac{200,000*0.005(1+0.005)^{24}}{(1+0.005)^{24}-1} = 8,864.12\)</span></p>
<hr />
<p><strong>Deriving the formula</strong></p>
<p>Forget about the above formula for a moment. With only information on <em>p</em>, <em>r</em> and <em>n</em>, you can easily calculate the first month’s interest amount. That’s probably as far as you get with the schedule without performing any trial and error. What method might you think of to determine a series of fixed amount that spreads out the principal repayment nicely across two years, pay interest according to the monthly balance and be left owing nothing at the end?</p>
<p>It is quite obvious to most that the present values of all monthly payments received in equal amounts must add up to the initial loan principal. This is translated into the present value formula:</p>
<p><span class="math display">\[P=\frac{A}{(1+r)}+\frac{A}{(1+r)^2}+\frac{A}{(1+r)^3}+\frac{A}{(1+r)^4}+...\frac{A}{(1+r)^n}\]</span></p>
<pre><code>        where
               P = Present Value of all future payments
               A = Constant Payment Amount
               r = Periodic interest
               n = Number of periods</code></pre>
<p>In other words, we want to achieve a series of numbers like Column “O” of the payment schedule, in which the summation of all the present value interest and principal payments compensates for the initial loan principal. Since the only known variables at this point are <em>P</em>, <em>r</em> and <em>n</em>, to find <em>A</em>, we need to simplify and re-arrange the formula.</p>
<p>From the previous section, we know that the sum of the geometric series formula is: <span class="math inline">\(S_n = \frac{a(1-r^n)}{(1-r)}\)</span>. Re-arranging it, we get <span class="math inline">\(a = \frac{S_n(1-r)}{1-r^n}\)</span></p>
<p>From the present value formula, if <span class="math inline">\(\frac{A}{(1+r)}\)</span> represents the 1<sup>st</sup> term of the geometric series <em>a</em>, <span class="math inline">\(\frac{1}{(1+r)}\)</span> the common ratio <em>r</em>, <em>n</em> the number of terms in the series, and <em>P</em> the sum, then substituting these into <span class="math inline">\(a = \frac{S_n(1-r)}{1-r^n}\)</span>:</p>
<p><span class="math display">\[\frac{A}{(1+r)}=\frac{P(1-\frac{1}{(1+r)})}{1-\frac{1}{(1+r)^n}}\]</span></p>
<p><span class="math display">\[A=\frac{P(\frac{r}{(1+r)})(1+r)}{\frac{(1+r)^n-1}{(1+r)^n}}\]</span></p>
<p><span class="math display">\[A=\frac{Pr(1+r)^n}{(1+r)^n-1}\]</span></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
